#!/bin/sh

# Script to install required external packages

# Set location of ruby to use
RUBY=/whome/harrop/opt/ruby/bin/ruby

# Set location of WFM
WFM_DIR=`pwd`

# Install libxml-ruby
echo "==========================================="
echo "= INSTALLING libxml-ruby                  ="
echo "==========================================="
cd ${WFM_DIR}
tar -xzvf libxml-ruby-1.1.3.tar.gz
ln -s libxml-ruby-1.1.3 libxml-ruby
cd ${WFM_DIR}/libxml-ruby/ext/libxml
${RUBY} extconf.rb
make clean
make

# Install sqlite3
echo "==========================================="
echo "= INSTALLING sqlite3                      ="
echo "==========================================="
cd ${WFM_DIR}
tar -xzvf sqlite-amalgamation-3.7.2.tar.gz
ln -s sqlite-3.7.2 sqlite3
cd ${WFM_DIR}/sqlite3
export CFLAGS="-Os -DSQLITE_ENABLE_COLUMN_METADATA"
./configure --prefix=`pwd`
make clean
make
make install
unset CFLAGS

# Install sqlite3-ruby
echo "==========================================="
echo "= INSTALLING sqlite3-ruby                 ="
echo "==========================================="
cd ${WFM_DIR}
tar -xzvf sqlite3-ruby-1.3.1.tar.gz
ln -s sqlite3-ruby-1.3.1 sqlite3-ruby
cd ${WFM_DIR}/sqlite3-ruby/ext/sqlite3
${RUBY} extconf.rb -- --with-sqlite3-dir=${WFM_DIR}/sqlite3
make clean
make
unset LDFLAGS

