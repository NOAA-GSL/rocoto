<?xml version="1.0"?> 
<!DOCTYPE workflow
[
 <!ENTITY CYCLE_TIME "@Y@m@d@H">
]>

<workflow realtime="f" scheduler="sge" cyclelifespan="0:01:00:00" cyclethrottle="10" corethrottle="5" taskthrottle="10">

  <log verbosity="10">/home/harrop/workflowmgr_dev/test/<cyclestr offset="2:00:00">test_@Y@m@d@H@M.log</cyclestr></log>

  <cycledef group="group1">201101010000 201201010000 1:00:00:00</cycledef>

  <task name="test1" maxtries="3">

    <command><cyclestr offset="-1:00:00">/home/harrop/test/bin/test_a.ksh -d @Y-@m-@d_%X @^p</cyclestr></command>

    <account>jetmgmt</account>

    <queue>nserial</queue>

    <cores>1</cores>

    <envar>
      <name><cyclestr>test1_@H</cyclestr></name>
      <value><cyclestr offset="1:00">hello world! &CYCLE_TIME;</cyclestr>This is some text<cyclestr offset="30:00">This is a 2nd cyclestr</cyclestr></value>
    </envar>
    <envar>
      <name><cyclestr>test2_@H</cyclestr></name>
      <value><cyclestr offset="1:00:00">goodbye cruel world! %X</cyclestr></value>
    </envar>
    <envar>
      <name>name1</name><value>value1</value>
    </envar>

    <dependency>
      <or>
        <and>
          <datadep age="2:00">/lfs1/jetmgmt/harrop/workflowmgr_dev/test/test.dat1</datadep>
          <datadep age="2:00">/lfs1/jetmgmt/harrop/workflowmgr_dev/test/test.dat2</datadep>
        </and>
<!--
        <and>
          <timedep>20111031120001</timedep>
          <timedep>20111031120003</timedep>
        </and>
-->
      </or>
    </dependency>

  </task>


  <task name="test2">

    <command><cyclestr offset="-1:00:00">/home/harrop/test/bin/test_a.ksh -d @Y-@m-@d_%X @^p</cyclestr></command>

    <account>jetmgmt</account>

    <queue>nserial</queue>

    <cores>1</cores>

    <envar><name><cyclestr>test1_@H</cyclestr></name><value><cyclestr>hello world! &CYCLE_TIME;</cyclestr></value></envar>
    <envar><name><cyclestr>test2_@H</cyclestr></name><value><cyclestr offset="1:00:00">goodbye cruel world! %X</cyclestr></value></envar>

    <dependency>
      <taskdep task="test1"></taskdep>
    </dependency>

  </task>


</workflow>
